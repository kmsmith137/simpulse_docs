

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pulsar profiles, and simulating pulsars &mdash; simpulse  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Miscellaneous" href="misc.html" />
    <link rel="prev" title="Pulsar phase models" href="phase_models.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> simpulse
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api_reference.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="single_pulse.html">Simulating FRB’s: class single_pulse</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase_models.html">Pulsar phase models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pulsar profiles, and simulating pulsars</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">simpulse</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="api_reference.html">API reference</a> &raquo;</li>
        
      <li>Pulsar profiles, and simulating pulsars</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pulsar-profiles-and-simulating-pulsars">
<h1>Pulsar profiles, and simulating pulsars<a class="headerlink" href="#pulsar-profiles-and-simulating-pulsars" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="simpulse.von_mises_profile">
<em class="property">class </em><code class="descclassname">simpulse.</code><code class="descname">von_mises_profile</code><a class="headerlink" href="#simpulse.von_mises_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a von Mises pulsar profile.  (Currently, the von Mises profile is the only
periodic profile implemented in simpulse, although in the future we might implement more profiles
and define a ‘pulsar_profile’ base class.)</p>
<p>Constructor syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">simpulse</span><span class="o">.</span><span class="n">von_mises_profile</span><span class="p">(</span><span class="n">duty_cycle</span><span class="p">,</span> <span class="n">detrend</span><span class="p">,</span> <span class="n">min_internal_nphi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li>The ‘duty_cycle’ is defined as D = (pulse full width at half maximum) / (pulse period).
A reasonable choice is D = 0.1 or so.</li>
<li>If the boolean variable ‘detrend’ is true, then the mean will be subtracted from the profile.</li>
<li>It is unlikely that you’ll need to set the ‘min_internal_nphi’ constructor argument, which
changes the number of phase bins used internally to represent the pulse.  If set to zero, then
a reasonable default value will be chosen.</li>
</ul>
</div></blockquote>
<p>In order to simulate a pulsar, you need two things: a phase model and a pulse profile.  Then, to do
the simulation, you can call either profile.eval_integrated_samples() or profile.add_integrated_samples().
These methods take the phase model as a parameter.</p>
<p>By default, the profile is normalized so that its peak flux is equal to 1 (before applying the detrending subtraction).
The normalization can be changed by setting the ‘peak_flux’ property, setting the ‘mean_flux’ propery, calling
set_single_pulse_signal_to_noise(), or calling set_multi_pulse_signal_to_noise().</p>
<p>Mathematically, a profile is just a function rho(phi) which gives the flux ‘rho’ as a function of pulse phase ‘phi’.
The von Mises profile is the functional form:</p>
<blockquote>
<div>rho(phi) = exp[ -2 kappa sin(pi*phi)^2 ]</div></blockquote>
<p>where kappa is a narrowness parameter, related to the duty cycle by kappa = log(2) / (2 sin^2(pi*D/2)).</p>
<dl class="attribute">
<dt id="simpulse.von_mises_profile.detrend">
<code class="descname">detrend</code><a class="headerlink" href="#simpulse.von_mises_profile.detrend" title="Permalink to this definition">¶</a></dt>
<dd><p>If this boolean variable is true, then the mean will be subtracted from the pulse profile.</p>
</dd></dl>

<dl class="attribute">
<dt id="simpulse.von_mises_profile.duty_cycle">
<code class="descname">duty_cycle</code><a class="headerlink" href="#simpulse.von_mises_profile.duty_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Duty cycle of the pulsar, defined as D = (pulse FWHM) / (pulse period).</p>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.eval_integrated_sample_slow">
<code class="descname">eval_integrated_sample_slow</code><span class="sig-paren">(</span><em>phi0</em>, <em>phi1</em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#simpulse.von_mises_profile.eval_integrated_sample_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is intended for debugging (hence the “_slow”!)
Returns the average flux over phase (not time) interval [phi0, phi1].</p>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.eval_integrated_samples">
<code class="descname">eval_integrated_samples</code><span class="sig-paren">(</span><em>t0</em>, <em>t1</em>, <em>nt</em>, <em>phase_model) -&gt; (1D array</em><span class="sig-paren">)</span><a class="headerlink" href="#simpulse.von_mises_profile.eval_integrated_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>This method can be used to simulate a pulsar in a regularly spaced sequence of time samples.</p>
<blockquote>
<div><ul class="simple">
<li>The ‘t0’ argument should be the <em>beginning</em> of the first time sample, and ‘t1’ should be the <em>end</em>
of the last time sample.  Thus, t1=t0+nt*dt, where dt is the length of a sample (not t1=t0+(nt-1)*dt).</li>
<li>The ‘phase_model’ argument should be an object of type ‘simpulse.phase_model_base’.</li>
<li>The output is a 1D array of length ‘nsamples’, containing simulated flux values.  Note that each
flux value is obtained by averaging (in time) the profile over the time sample, not instantanously
sampling at the midpoint.</li>
</ul>
</div></blockquote>
<p>Reminder: if the ‘detrend’ flag was specified at construction, then the simulated flux will be detrended.</p>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.get_multi_pulse_signal_to_noise">
<code class="descname">get_multi_pulse_signal_to_noise</code><span class="sig-paren">(</span><em>total_time</em>, <em>dt_sample</em>, <em>pulse_freq</em>, <em>sample_rms=1.0</em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#simpulse.von_mises_profile.get_multi_pulse_signal_to_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total SNR of a train of pulses, accounting for finite time resolution (and detrending,
if detrend=True was specified at construction).</p>
<p>Strictly speaking, this is an approximation to the true SNR, which may slightly depend
on the exact arrival times of the pulses.</p>
<blockquote>
<div><ul class="simple">
<li>The ‘total_time’ argument is the total duration of the pulse train.</li>
<li>The ‘dt_sample’ argument is the length of each time sample.</li>
<li>The ‘pulse_freq’ argument is the pulse frequency.</li>
<li>The ‘sample_rms’ argument is the RMS noise fluctuation in each time sample.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.get_profile_fft">
<code class="descname">get_profile_fft</code><span class="sig-paren">(</span><em>nout=0) -&gt; (1D array</em><span class="sig-paren">)</span><a class="headerlink" href="#simpulse.von_mises_profile.get_profile_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Fourier transform of the profile:</p>
<blockquote>
<div>rho_m = int_0^1 dphi rho(phi) e^{i m phi}.</div></blockquote>
<p>Note that rho_m is real, and rho_m = rho_{-m}, since the von Mises profile is symmetric.</p>
<p>The DC mode rho_0 will equal ‘mean_flux’ if detrend=False, or 0 if detrend=True.</p>
<p>The return value is a 1D array of length ‘nout’.  If nout=0 (the default), then it defaults to
(internal_nphi/2+1), the number of Fourier coefficients which are computed internally.  (If ‘nout’
is larger than this, then the returned array is zero-padded.</p>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.get_single_pulse_signal_to_noise">
<code class="descname">get_single_pulse_signal_to_noise</code><span class="sig-paren">(</span><em>dt_sample</em>, <em>pulse_freq</em>, <em>sample_rms=1.0</em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#simpulse.von_mises_profile.get_single_pulse_signal_to_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the SNR of a single pulse, accounting for finite time resolution (and detrending,
if detrend=True was specified at construction).</p>
<p>Strictly speaking, the return value is an approximation to the true SNR, which may slightly depend
on the exact arrival time of the pulse.</p>
<blockquote>
<div><ul class="simple">
<li>The ‘dt_sample’ argument is the length of each time sample.</li>
<li>The ‘pulse_freq’ argument is the pulse frequency.</li>
<li>The ‘sample_rms’ argument is the RMS noise fluctuation in each time sample.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="simpulse.von_mises_profile.internal_nphi">
<code class="descname">internal_nphi</code><a class="headerlink" href="#simpulse.von_mises_profile.internal_nphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of phase bins used internally to represent the pulse.</p>
</dd></dl>

<dl class="attribute">
<dt id="simpulse.von_mises_profile.mean_flux">
<code class="descname">mean_flux</code><a class="headerlink" href="#simpulse.von_mises_profile.mean_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean flux of the pulse (settable property).</p>
</dd></dl>

<dl class="attribute">
<dt id="simpulse.von_mises_profile.peak_flux">
<code class="descname">peak_flux</code><a class="headerlink" href="#simpulse.von_mises_profile.peak_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Peak flux of the pulse (settable property).</p>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.point_eval">
<code class="descname">point_eval</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#simpulse.von_mises_profile.point_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the instantaneous flux evaluated at pulse phase ‘phi’.
Reminder: if the ‘detrend’ flag was specified at construction, then the simulated flux will be detrended.</p>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.set_multi_pulse_signal_to_noise">
<code class="descname">set_multi_pulse_signal_to_noise</code><span class="sig-paren">(</span><em>snr</em>, <em>total_time</em>, <em>dt_sample</em>, <em>pulse_freq</em>, <em>sample_rms=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#simpulse.von_mises_profile.set_multi_pulse_signal_to_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the pulse normalization to give the specified multi-pulse signal-to-noise ratio.
For more information and description of the arguments, see the get_multi_pulse_signal_to_noise() docstring.</p>
</dd></dl>

<dl class="method">
<dt id="simpulse.von_mises_profile.set_single_pulse_signal_to_noise">
<code class="descname">set_single_pulse_signal_to_noise</code><span class="sig-paren">(</span><em>snr</em>, <em>dt_sample</em>, <em>pulse_freq</em>, <em>sample_rms=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#simpulse.von_mises_profile.set_single_pulse_signal_to_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the pulse normalization to give the specified single-pulse signal-to-noise ratio.
For more information and description of the arguments, see the get_single_pulse_signal_to_noise() docstring.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="misc.html" class="btn btn-neutral float-right" title="Miscellaneous" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="phase_models.html" class="btn btn-neutral" title="Pulsar phase models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>